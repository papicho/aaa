(this["webpackJsonpfindar-backoffice-school"]=this["webpackJsonpfindar-backoffice-school"]||[]).push([[0],{154:function(e,t,a){e.exports=a.p+"static/media/unknown.ef288af2.png"},337:function(e,t,a){e.exports=a(479)},479:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(14),c=a.n(o),l=a(564),i=a(565),s=a(566),u=a(554),m=a(571),g=a(567),d=a(557),p=a(572),f=a(560),E=function(e){return e.record?e.record.active?r.a.createElement("div",null,"Active"):r.a.createElement("div",null,"Not Active"):null},h={resourceName:"checkpoints",resource:r.a.createElement(f.a,{name:"checkpoint",list:function(e){return r.a.createElement(i.a,e,r.a.createElement(s.a,{rowClick:"edit",title:"Post edition"},r.a.createElement(u.a,{source:"name"}),r.a.createElement(u.a,{source:"building"}),r.a.createElement(u.a,{source:"checkpointType"}),r.a.createElement(u.a,{source:"floor"}),r.a.createElement(u.a,{source:"school"}),r.a.createElement(u.a,{source:"country"}),r.a.createElement(u.a,{source:"city"}),r.a.createElement(u.a,{source:"neighbors"})))},edit:function(e){return r.a.createElement(m.a,e,r.a.createElement(g.a,null,r.a.createElement(d.a,{source:"name"}),r.a.createElement(d.a,{source:"building"}),r.a.createElement(d.a,{source:"checkpointType"}),r.a.createElement(d.a,{source:"floor"}),r.a.createElement(d.a,{source:"school"}),r.a.createElement(d.a,{source:"country"}),r.a.createElement(d.a,{source:"city"}),r.a.createElement(d.a,{source:"neighbors"}),r.a.createElement(E,null)))},create:function(e){return r.a.createElement(p.a,e,r.a.createElement(g.a,null,r.a.createElement(d.a,{source:"name"}),r.a.createElement(d.a,{source:"building"}),r.a.createElement(d.a,{source:"checkpointType"}),r.a.createElement(d.a,{source:"floor"}),r.a.createElement(d.a,{source:"school"}),r.a.createElement(d.a,{source:"country"}),r.a.createElement(d.a,{source:"city"}),r.a.createElement(d.a,{source:"neighbors"})))},options:{label:"Checkpoints"}})},y=a(574),v=a(575),b=a(568),k=a(576),S=a(569),O=a(563),w=a(159),N=a(573),P=a(102),T=a(296),j=a(4),J=a(562),A=a(484),I=a(552),M=a(561),R=a(154),C=a.n(R),L=Object(w.a)({list:{width:300,height:400,margin:10},fullList:{width:"auto",height:40}});function D(){var e=L(),t=r.a.useState({top:!1,left:!1,bottom:!1,right:!1}),a=Object(T.a)(t,2),n=a[0],o=a[1],c=function(e,t){return function(a){("keydown"!==a.type||"Tab"!==a.key&&"Shift"!==a.key)&&o(Object(P.a)(Object(P.a)({},n),{},{[e]:t}))}};return r.a.createElement("div",null,["Picture"].map((function(t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(A.a,{onClick:c(t,!0)},t),r.a.createElement(J.a,{anchor:t,open:n[t],onClose:c(t,!1)},function(t){return r.a.createElement("div",{className:Object(j.a)(e.list,{[e.fullList]:"top"===t||"bottom"===t}),role:"presentation",onClick:c(t,!1),onKeyDown:c(t,!1)},r.a.createElement(I.a,null,["Picture"].map((function(t,a){return r.a.createElement(N.a,{src:C.a,className:e.list})}))),r.a.createElement(M.a,null))}(t)))})))}var x=Object(w.a)((function(e){return{root:{display:"flex","& > *":{margin:e.spacing(1)}},small:{width:e.spacing(3),height:e.spacing(3)},large:{width:e.spacing(7),height:e.spacing(7)}}})),B={resourceName:"users",resource:r.a.createElement(f.a,{name:"user",list:function(e){return r.a.createElement(i.a,e,r.a.createElement(s.a,{rowClick:"edit"},r.a.createElement(u.a,{source:"id"}),r.a.createElement(y.a,{source:"email"}),r.a.createElement(u.a,{source:"role"}),r.a.createElement(u.a,{source:"school"})))},edit:function(e){return r.a.createElement(m.a,e,r.a.createElement(g.a,null,r.a.createElement(d.a,{source:"email"}),r.a.createElement(d.a,{source:"school"}),r.a.createElement(v.a,{source:"role",choices:[{id:"STAFF",name:"Staff"},{id:"STUDENT",name:"Student"}]})))},create:function(e){return r.a.createElement(p.a,e,r.a.createElement(g.a,null,r.a.createElement(D,null),r.a.createElement(b.a,null,r.a.createElement(k.a,{label:"summary"},r.a.createElement(d.a,{source:"email"}),r.a.createElement(d.a,{type:"password",source:"password"})),r.a.createElement(k.a,{label:"Picture",path:"body"},r.a.createElement(N.a,{src:C.a,className:x("large")}),r.a.createElement(S.a,{source:"pictures",label:"Related pictures",accept:"image/*"},r.a.createElement(O.a,{source:"src",title:"title"}))))))},options:{label:"Users"}})},F=a(196),_=a.n(F),U=a(283),q={login:function(){var e=Object(U.a)(_.a.mark((function e(t){var a,n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.password,r=new Request("https://findar-api-staging.herokuapp.com/user/login",{method:"POST",body:JSON.stringify({email:a,password:n}),headers:new Headers({"Content-Type":"application/json"})}),console.log(a),console.log(n),e.abrupt("return",fetch(r).then((function(e){if(e.status<200||e.status>=300)throw new Error(e.statusText);return e.json()})).then((function(e){var t=e.token;localStorage.setItem("token",t),console.log(t)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){return localStorage.removeItem("username"),localStorage.removeItem("token"),Promise.resolve()},checkError:function(e){var t=e.status;return 401===t||403===t?(localStorage.removeItem("username"),Promise.reject()):Promise.resolve()},checkAuth:function(){return localStorage.getItem("token")?Promise.resolve():Promise.reject()},getPermissions:function(){return Promise.resolve()}},z=a(73),G=a(133),H=Object(G.a)("https://findar-api-staging.herokuapp.com",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.user={authenticated:!0,token:"Bearer "+localStorage.getItem("token")},console.log(localStorage.getItem("token")),z.a.fetchJson(e,t)})),K={getList:function(e,t){return console.log(e),console.log("PARAMS ARE : "),console.log(t),"checkpoint"==e?H.getList(e,t).then((function(e){var t=[];return e.data.forEach((function(e){t.push({id:e._id,name:e.name,building:e.building,checkpointType:e.checkpointType,floor:e.floor,neighbors:e.neighbors,school:e.location.school,country:e.location.country,city:e.location.city})})),console.log("Data returned from data provider in getList:"),console.log(JSON.stringify(t,null,8)),{data:t,total:t.length}})):"user"==e?H.getList(e,t).then((function(t){var a=[];return t.data.forEach((function(e){a.push({id:e._id,email:e.email,school:e.school,role:e.role})})),console.log("ressource ====="),console.log(e),console.log("Data returned from data provider in getList:"),console.log(JSON.stringify(a,null,8)),{data:a,total:a.length}})):void 0},getMany:function(e,t){return H.getMany(e,t)},updateMany:function(e,t){return H.updateMany(e,t)},create:function(e,t){return console.log("param de create :"),console.log(t),e+="/signup",H.create(e,t)},delete:function(e,t){return H.delete(e,t)},deleteMany:function(e,t){return H.deleteMany(e,t)},getManyReference:function(e,t){var a=t.pagination,n=a.page,r=a.perPage,o=t.sort,c=o.field,l=o.order,i=(JSON.stringify([c,l]),JSON.stringify([(n-1)*r,n*r-1]),JSON.stringify(Object(P.a)(Object(P.a)({},t.filter),{},{[t.target]:t.id})),"".concat("https://findar-api-staging.herokuapp.com","/").concat(e));return H.httpClient(i).then((function(e){var t=e.headers;return{zebi:e.json,total:parseInt(t.get("content-range").split("/").pop(),10)}}))},getOne:function(e,t){return console.log("LES PARAMETRE de GETONE SONT "),console.log(t),"user"==e&&t.hasOwnProperty("id")&&(e+="/profile"),H.getOne(e,t).then((function(e){var t={id:e.data._id,email:e.data.email,school:e.data.school};return console.log("Data returned from data provider in getoooooooooOne:"),console.log(JSON.stringify(t,null,8)),{data:t}}))},update:function(e,t){return console.log("SA REEEENTRE"),console.log("Data provided by react-admin to data provider:"),console.log(JSON.stringify(t,null,8)),e+="/profile",H.update(e,t)}},Q=function(){return r.a.createElement(l.a,{authProvider:q,dataProvider:K},h.resource,B.resource)};c.a.render(r.a.createElement(Q,null),document.getElementById("root"));var V=Q,W=document.getElementById("root");c.a.render(r.a.createElement(V,null),W)}},[[337,1,2]]]);
//# sourceMappingURL=main.db4fa2bc.chunk.js.map