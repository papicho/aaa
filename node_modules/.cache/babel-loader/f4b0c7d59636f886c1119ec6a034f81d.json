{"ast":null,"code":"import _objectSpread from \"/Users/youneskhelil/Desktop/findar-backoffice-school/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Admin, Resource, fetchUtils } from \"react-admin\";\nimport jsonServerProvider from \"ra-data-json-server\";\nimport dataProvider from './dataProvider';\nvar dataProviderWrapper = {\n  getList: function getList(resource, params) {\n    console.log(\"FN =\"); //console.log(localStorage.getItem('username'))\n    //var emailUser = localStorage.getItem('username')\n    //var userSchool = emailUser.split('.')\n    //localStorage.setItem(\"fn\", userSchool[0])\n    //var schoolName = userSchool[1].split('@')\n    //localStorage.setItem('schoolName', schoolName[1])\n    //console.log(schoolName[1])\n\n    console.log(resource);\n    console.log(\"PARAMS ARE : \");\n    console.log(params);\n\n    if (resource === \"checkpoint\") {\n      return dataProvider.getList(resource, params).then(function (result) {\n        /**\n         * filtering data to only return only certain fields\n         * imagine I have a custom data provider that runs on top of graphql\n         * and only returns certain fields in getList\n         */\n        var newData = [];\n        result.data.forEach(function (record) {\n          console.log(\"record location school :\");\n          var email = localStorage.getItem(\"username\");\n          var name = email.substring(0, email.lastIndexOf(\"@\"));\n          var domain = email.substring(email.lastIndexOf(\"@\") + 1);\n          var fullname = name.split(\".\");\n          var fn = fullname[0];\n          var ln = fullname[1];\n          var loginSchool0 = domain.split(\".\");\n          var loginSchool = loginSchool0[0];\n          console.log(\"dans getlist ressource user avec comme loginSchool:\");\n          console.log(loginSchool);\n          var tmp = record.location.school.toLowerCase();\n\n          if (tmp) {\n            var n = tmp.includes(loginSchool);\n            console.log(\"dans  NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\");\n            console.log(tmp);\n\n            if (n) {\n              newData.push({\n                id: record._id,\n                name: record.name,\n                building: record.building,\n                checkpointType: record.checkpointType,\n                floor: record.floor,\n                neighbors: record.neighbors,\n                school: record.location.school,\n                country: record.location.country,\n                city: record.location.city\n              });\n            }\n          } //if (record.location.school.toLowerCase() == localStorage.getItem('schoolName').toLowerCase()) {\n          //}\n\n        });\n        console.log(\"Data returned from data provider in getList:\");\n        console.log(JSON.stringify(newData, null, 8));\n        return {\n          data: newData,\n          total: newData.length\n        };\n      });\n    } else if (resource === \"user\") {\n      return dataProvider.getList(resource, params).then(function (result) {\n        /**\n         * filtering data to only return only certain fields\n         * imagine I have a custom data provider that runs on top of graphql\n         * and only returns certain fields in getList\n         */\n        var newData = [];\n        result.data.forEach(function (record) {\n          var email = localStorage.getItem(\"username\");\n          var name = email.substring(0, email.lastIndexOf(\"@\"));\n          var domain = email.substring(email.lastIndexOf(\"@\") + 1);\n          var fullname = name.split(\".\");\n          var fn = fullname[0];\n          var ln = fullname[1];\n          var loginSchool0 = domain.split(\".\");\n          var loginSchool = loginSchool0[0];\n          console.log(\"dans getlist ressource user avec comme loginSchool:\");\n          console.log(loginSchool);\n          var tmp = record.school;\n\n          if (tmp) {\n            tmp = tmp.toLowerCase();\n            console.log(\"dans if recodschool ressource user:\"); //var tmp = record.school\n            //  if (tmp == .toLowerCase()) {\n\n            var n = tmp.includes(loginSchool);\n            console.log(\"dans  NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\");\n            console.log(tmp);\n\n            if (n) {\n              newData.push({\n                id: record._id,\n                email: record.email,\n                school: record.school,\n                role: record.role\n              });\n            }\n          }\n        });\n        console.log(\"ressource =====\");\n        console.log(resource);\n        console.log(\"Data returned from data provider in getList:\");\n        console.log(JSON.stringify(newData, null, 8));\n        return {\n          data: newData,\n          total: newData.length\n        };\n      });\n    }\n  },\n  getMany: function getMany(resource, params) {\n    return dataProvider.getMany(resource, params);\n  },\n  updateMany: function updateMany(resource, params) {\n    return dataProvider.updateMany(resource, params);\n  },\n  create: function create(resource, params) {\n    if (resource === \"checkpoint\") {\n      //if (params.hasOwnProperty('location')) {console.log(\"OUAIS ELLE LA LOCATION!!!\")}\n      console.log(\"sa rentre dans create check point avec les params suivant\");\n      console.log(params);\n      console.log(\"jessaie de creer un checkpoint et mes params sont :\");\n      console.log(JSON.stringify(params, null, 8));\n    } else if (resource === \"user\") {\n      resource = resource + \"/signup\";\n    }\n\n    console.log(\"param de create :\");\n    console.log(params);\n    return dataProvider.create(resource, params);\n  },\n  delete: function _delete(resource, params) {\n    return dataProvider.delete(resource, params);\n  },\n  deleteMany: function deleteMany(resource, params) {\n    return dataProvider.deleteMany(resource, params);\n  },\n  getManyReference: function getManyReference(resource, params) {\n    var _params$pagination = params.pagination,\n        page = _params$pagination.page,\n        perPage = _params$pagination.perPage;\n    var _params$sort = params.sort,\n        field = _params$sort.field,\n        order = _params$sort.order;\n    var query = {\n      sort: JSON.stringify([field, order]),\n      range: JSON.stringify([(page - 1) * perPage, page * perPage - 1]),\n      filter: JSON.stringify(_objectSpread(_objectSpread({}, params.filter), {}, {\n        [params.target]: params.id\n      }))\n    };\n    var apiUrl = \"https://findar-api-staging.herokuapp.com\";\n    var url = \"\".concat(apiUrl, \"/\").concat(resource); //const url = `${apiUrl}/${resource}?floor=2`;\n\n    return dataProvider.httpClient(url).then(function (_ref) {\n      var headers = _ref.headers,\n          json = _ref.json;\n      return {\n        zebi: json,\n        total: parseInt(headers.get('content-range').split('/').pop(), 10)\n      };\n    });\n  },\n  getOne: function getOne(resource, params) {\n    if (params.id) {\n      console.log(\"LES PARAMETRE de GETONE SONT \");\n      console.log(params);\n\n      if (resource === \"user\" && params.hasOwnProperty('id')) {\n        resource = resource + \"/profile\";\n      } //else if (resource == \"checkpoint\" && params.hasOwnProperty('id') )\n      //{  resource = resource}\n\n\n      return dataProvider.getOne(resource, params).then(function (result) {\n        var newData = {\n          id: result.data._id,\n          email: result.data.email,\n          school: result.data.school\n        };\n        console.log(\"Data returned from data provider in getoooooooooOne:\");\n        console.log(JSON.stringify(newData, null, 8));\n        return {\n          data: newData\n        };\n      });\n    }\n  },\n  update: function update(resource, params) {\n    console.log(\"SA REEEENTRE\");\n    console.log(\"Data provided by react-admin to data provider:\");\n    console.log(JSON.stringify(params, null, 8));\n    resource = resource + \"/profile\";\n    return dataProvider.update(resource, params);\n  }\n};\nexport default dataProviderWrapper;","map":{"version":3,"sources":["/Users/youneskhelil/Desktop/findar-backoffice-school/src/Resources/dataProviderWrapper.js"],"names":["React","ReactDOM","Admin","Resource","fetchUtils","jsonServerProvider","dataProvider","dataProviderWrapper","getList","resource","params","console","log","then","result","newData","data","forEach","record","email","localStorage","getItem","name","substring","lastIndexOf","domain","fullname","split","fn","ln","loginSchool0","loginSchool","tmp","location","school","toLowerCase","n","includes","push","id","_id","building","checkpointType","floor","neighbors","country","city","JSON","stringify","total","length","role","getMany","updateMany","create","delete","deleteMany","getManyReference","pagination","page","perPage","sort","field","order","query","range","filter","target","apiUrl","url","httpClient","headers","json","zebi","parseInt","get","pop","getOne","hasOwnProperty","update"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Admin, Resource, fetchUtils } from \"react-admin\";\nimport jsonServerProvider from \"ra-data-json-server\";\nimport dataProvider from './dataProvider';\n\n\nconst dataProviderWrapper = {\n  getList: (resource, params) => {\n    console.log(\"FN =\")\n    //console.log(localStorage.getItem('username'))\n    //var emailUser = localStorage.getItem('username')\n    //var userSchool = emailUser.split('.')\n    //localStorage.setItem(\"fn\", userSchool[0])\n    //var schoolName = userSchool[1].split('@')\n    //localStorage.setItem('schoolName', schoolName[1])\n    //console.log(schoolName[1])\n    console.log(resource)\n    console.log(\"PARAMS ARE : \")\n    console.log(params)\n    if (resource === \"checkpoint\")\n    {\n        return dataProvider.getList(resource, params).then(result => {\n          /**\n           * filtering data to only return only certain fields\n           * imagine I have a custom data provider that runs on top of graphql\n           * and only returns certain fields in getList\n           */\n          const newData = [];\n          result.data.forEach(record => {\n            console.log(\"record location school :\")\n            let email = localStorage.getItem(\"username\")\n            var name   = email.substring(0, email.lastIndexOf(\"@\"));\n            var domain = email.substring(email.lastIndexOf(\"@\") +1);\n            let fullname = name.split(\".\")\n            let fn = fullname[0]\n            let ln = fullname[1]\n            let loginSchool0 = domain.split(\".\")\n            let loginSchool = loginSchool0[0]\n\n            console.log(\"dans getlist ressource user avec comme loginSchool:\")\n            console.log(loginSchool)\n            let tmp = record.location.school.toLowerCase()\n\n            if (tmp)\n            {\n              let n = tmp.includes(loginSchool);\n                console.log(\"dans  NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\")\n                console.log(tmp)\n\n                if (n)\n                {\n              newData.push({\n                id: record._id,\n                name: record.name,\n                building: record.building,\n                checkpointType: record.checkpointType,\n                floor: record.floor,\n                neighbors: record.neighbors,\n                school: record.location.school,\n                country: record.location.country,\n                city: record.location.city\n              });\n            }\n            }\n            //if (record.location.school.toLowerCase() == localStorage.getItem('schoolName').toLowerCase()) {\n\n\n          //}\n\n          });\n          console.log(`Data returned from data provider in getList:`);\n          console.log(JSON.stringify(newData, null, 8));\n          return { data: newData, total: newData.length };\n        });\n    }\n    else if (resource === \"user\")\n    {\n        return dataProvider.getList(resource, params).then(result => {\n          /**\n           * filtering data to only return only certain fields\n           * imagine I have a custom data provider that runs on top of graphql\n           * and only returns certain fields in getList\n           */\n          const newData = [];\n          result.data.forEach(record => {\n            let email = localStorage.getItem(\"username\")\n            var name   = email.substring(0, email.lastIndexOf(\"@\"));\n            var domain = email.substring(email.lastIndexOf(\"@\") +1);\n            let fullname = name.split(\".\")\n            let fn = fullname[0]\n            let ln = fullname[1]\n            let loginSchool0 = domain.split(\".\")\n            let loginSchool = loginSchool0[0]\n\n            console.log(\"dans getlist ressource user avec comme loginSchool:\")\n            console.log(loginSchool)\n            let tmp = record.school\n            if (tmp)\n            {\n              tmp = tmp.toLowerCase()\n              console.log(\"dans if recodschool ressource user:\")\n\n\n                  //var tmp = record.school\n                //  if (tmp == .toLowerCase()) {\n                let n = tmp.includes(loginSchool);\n                  console.log(\"dans  NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\")\n                  console.log(tmp)\n\n                  if (n)\n                  {\n                    newData.push({\n                      id: record._id,\n                      email: record.email,\n                      school: record.school,\n                      role: record.role\n                    });\n                  }\n\n\n            }\n          });\n          console.log(\"ressource =====\")\n          console.log(resource)\n          console.log(`Data returned from data provider in getList:`);\n          console.log(JSON.stringify(newData, null, 8));\n\n          return { data: newData, total: newData.length };\n\n        });\n    }\n  },\n  getMany: (resource, params) => dataProvider.getMany(resource, params),\n  updateMany: (resource, params) => dataProvider.updateMany(resource, params),\n  create: (resource, params) => {\n    if (resource === \"checkpoint\")\n {\n    //if (params.hasOwnProperty('location')) {console.log(\"OUAIS ELLE LA LOCATION!!!\")}\n      console.log(\"sa rentre dans create check point avec les params suivant\")\n      console.log(params)\n\n   console.log(\"jessaie de creer un checkpoint et mes params sont :\")\n   console.log(JSON.stringify(params, null, 8))\n\n }\n else if (resource === \"user\")\n{\n  resource = resource + \"/signup\"\n}\n    console.log(\"param de create :\");\n    console.log(params);\n    return dataProvider.create(resource, params)\n  },\n  delete: (resource, params) => dataProvider.delete(resource, params),\n  deleteMany: (resource, params) => dataProvider.deleteMany(resource, params),\n\n\n\n\n\n\n\n      getManyReference: (resource, params) => {\n          const { page, perPage } = params.pagination;\n          const { field, order } = params.sort;\n          const query = {\n              sort: JSON.stringify([field, order]),\n              range: JSON.stringify([(page - 1) * perPage, page * perPage - 1]),\n              filter: JSON.stringify({\n                  ...params.filter,\n                  [params.target]: params.id,\n              }),\n          };\n          const apiUrl = \"https://findar-api-staging.herokuapp.com\"\n          const url = `${apiUrl}/${resource}`;\n          //const url = `${apiUrl}/${resource}?floor=2`;\n\n          return dataProvider.httpClient(url).then(({ headers, json }) => ({\n              zebi: json,\n              total: parseInt(headers.get('content-range').split('/').pop(), 10),\n          }));\n      },\n  getOne: (resource, params) => {\n    if (params.id) {\n\n\n    console.log(\"LES PARAMETRE de GETONE SONT \")\n    console.log(params)\n    if (resource === \"user\" && params.hasOwnProperty('id') )\n    {  resource = resource + \"/profile\"  }\n    //else if (resource == \"checkpoint\" && params.hasOwnProperty('id') )\n    //{  resource = resource}\n\n    return dataProvider.getOne(resource, params).then(result => {\n\n\n      const newData = {\n        id: result.data._id,\n        email: result.data.email,\n        school: result.data.school,\n      };\n      console.log(`Data returned from data provider in getoooooooooOne:`);\n      console.log(JSON.stringify(newData, null, 8));\n      return { data: newData };\n    });\n    }\n  },\n  update: (resource, params) => {\n    console.log(\"SA REEEENTRE\")\n    console.log(\"Data provided by react-admin to data provider:\");\n    console.log(JSON.stringify(params, null, 8));\n    resource = resource + \"/profile\"\n    return dataProvider.update(resource, params);\n  }\n};\n\nexport default dataProviderWrapper;\n"]},"metadata":{},"sourceType":"module"}